<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forms - Session Replay Test</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <script src="js/tracker.js"></script>
</head>
<body data-page="forms">
  <header class="top-header">
    <div class="top-header-left">
      <a href="index.html" class="header-logo">
        <div class="header-logo-icon">U</div>
        <span class="header-logo-text">uzera</span>
      </a>
      <div class="header-page-title">
        <span class="material-icons">security</span>
        <span>Session Replay Test</span>
      </div>
    </div>
    <div class="top-header-right">
      <div class="user-profile" onclick="openIdentifyModal()">
        <div class="user-avatar" id="userAvatarDisplay">TS</div>
        <span class="user-name" id="userNameDisplay">Test User</span>
        <span class="material-icons" style="font-size: 18px; color: var(--text-muted);">expand_more</span>
      </div>
    </div>
  </header>

  <nav>
    <div class="nav-links">
      <a class="nav-link" href="index.html">Home</a>
      <a class="nav-link" href="pii.html">PII</a>
      <a class="nav-link" href="auth.html">Auth</a>
      <a class="nav-link" href="financial.html">Financial</a>
      <a class="nav-link" href="sensitive.html">IDs</a>
      <a class="nav-link" href="health.html">Health</a>
      <a class="nav-link" href="inputs.html">Inputs</a>
      <a class="nav-link" href="ui.html">UI</a>
      <a class="nav-link" href="network.html">Network</a>
      <a class="nav-link" href="pages.html">Pages</a>
      <a class="nav-link" href="clicks.html">Clicks</a>
      <a class="nav-link" href="custom.html">Custom</a>
      <a class="nav-link" href="thirdparty.html">3rd Party</a>
      <a class="nav-link" href="storage.html">Storage</a>
      <a class="nav-link" href="clipboard.html">Clipboard</a>
      <a class="nav-link" href="geolocation.html">Location</a>
      <a class="nav-link" href="media.html">Media</a>
      <a class="nav-link" href="autofill.html">Autofill</a>
      <a class="nav-link" href="urldata.html">URL</a>
      <a class="nav-link" href="international.html">Intl</a>
      <a class="nav-link" href="recovery.html">2FA</a>
      <a class="nav-link" href="graphics.html">Graphics</a>
      <a class="nav-link" href="errors.html">Errors</a>
      <a class="nav-link" href="api.html">API</a>
      <a class="nav-link active" href="forms.html">Forms</a>
    </div>
  </nav>

  <div class="page">
    <h1>Form Analytics</h1>
    <p class="page-desc"><span class="badge-info">ANALYTICS</span> Track form interactions, submissions, and abandonment</p>

    <div class="info-box"><p>Test form analytics by interacting with various form types. Track field focus, blur, changes, validation errors, and submissions.</p></div>

    <!-- Form Analytics Summary -->
    <div class="card">
      <h3>Form Analytics Summary</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-md);">
        <div style="text-align: center; padding: var(--spacing-md); background: var(--bg-tertiary); border-radius: var(--radius-md);">
          <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);" id="totalSubmissions">0</div>
          <div class="text-sm text-muted">Total Submissions</div>
        </div>
        <div style="text-align: center; padding: var(--spacing-md); background: var(--bg-tertiary); border-radius: var(--radius-md);">
          <div style="font-size: 2rem; font-weight: 700; color: var(--success-color);" id="successfulSubmissions">0</div>
          <div class="text-sm text-muted">Successful</div>
        </div>
        <div style="text-align: center; padding: var(--spacing-md); background: var(--bg-tertiary); border-radius: var(--radius-md);">
          <div style="font-size: 2rem; font-weight: 700; color: var(--danger-color);" id="failedSubmissions">0</div>
          <div class="text-sm text-muted">Failed/Errors</div>
        </div>
        <div style="text-align: center; padding: var(--spacing-md); background: var(--bg-tertiary); border-radius: var(--radius-md);">
          <div style="font-size: 2rem; font-weight: 700; color: var(--warning-color);" id="abandonedForms">0</div>
          <div class="text-sm text-muted">Abandoned</div>
        </div>
      </div>
      <button class="btn btn-secondary btn-sm mt-05" onclick="resetFormAnalytics()">Reset Analytics</button>
    </div>

    <!-- Contact Form -->
    <div class="card">
      <h3>1. Contact Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Basic contact form with validation</p>
      <form id="contactForm" onsubmit="handleFormSubmit(event, 'contact')">
        <div class="form-row">
          <div class="form-group">
            <label>First Name <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="firstName" required placeholder="John" data-form="contact">
          </div>
          <div class="form-group">
            <label>Last Name <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="lastName" required placeholder="Doe" data-form="contact">
          </div>
        </div>
        <div class="form-group">
          <label>Email <span style="color: var(--danger-color);">*</span></label>
          <input type="email" name="email" required placeholder="john@example.com" data-form="contact">
        </div>
        <div class="form-group">
          <label>Phone</label>
          <input type="tel" name="phone" placeholder="+1 (555) 123-4567" data-form="contact">
        </div>
        <div class="form-group">
          <label>Subject <span style="color: var(--danger-color);">*</span></label>
          <select name="subject" required data-form="contact">
            <option value="">Select a subject...</option>
            <option value="general">General Inquiry</option>
            <option value="support">Technical Support</option>
            <option value="sales">Sales Question</option>
            <option value="feedback">Feedback</option>
          </select>
        </div>
        <div class="form-group">
          <label>Message <span style="color: var(--danger-color);">*</span></label>
          <textarea name="message" rows="4" required placeholder="Your message here..." data-form="contact"></textarea>
        </div>
        <div style="display: flex; gap: var(--spacing-sm);">
          <button type="submit" class="btn btn-primary btn-sm">Submit</button>
          <button type="reset" class="btn btn-secondary btn-sm">Clear</button>
        </div>
      </form>
    </div>

    <!-- Registration Form -->
    <div class="card">
      <h3>2. Registration Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">User registration with password validation</p>
      <form id="registrationForm" onsubmit="handleFormSubmit(event, 'registration')">
        <div class="form-group">
          <label>Username <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="username" required placeholder="johndoe123" minlength="3" data-form="registration">
        </div>
        <div class="form-group">
          <label>Email <span style="color: var(--danger-color);">*</span></label>
          <input type="email" name="email" required placeholder="john@example.com" data-form="registration">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Password <span style="color: var(--danger-color);">*</span></label>
            <div class="password-wrapper">
              <input type="password" name="password" id="regPassword" required minlength="8" placeholder="Min 8 characters" data-form="registration">
              <button type="button" class="toggle-password" onclick="togglePassword('regPassword', this)">Show</button>
            </div>
          </div>
          <div class="form-group">
            <label>Confirm Password <span style="color: var(--danger-color);">*</span></label>
            <div class="password-wrapper">
              <input type="password" name="confirmPassword" id="regConfirmPassword" required placeholder="Repeat password" data-form="registration">
              <button type="button" class="toggle-password" onclick="togglePassword('regConfirmPassword', this)">Show</button>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label>Date of Birth</label>
          <input type="date" name="dob" data-form="registration">
        </div>
        <div class="form-group">
          <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer;">
            <input type="checkbox" name="terms" required data-form="registration">
            <span>I agree to the Terms of Service <span style="color: var(--danger-color);">*</span></span>
          </label>
        </div>
        <div class="form-group">
          <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer;">
            <input type="checkbox" name="newsletter" data-form="registration">
            <span>Subscribe to newsletter</span>
          </label>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Create Account</button>
      </form>
    </div>

    <!-- Payment Form -->
    <div class="card">
      <h3>3. Payment Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Credit card payment form (test data only)</p>
      <form id="paymentForm" onsubmit="handleFormSubmit(event, 'payment')">
        <div class="form-group">
          <label>Cardholder Name <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="cardholderName" required placeholder="John Doe" autocomplete="cc-name" data-form="payment">
        </div>
        <div class="form-group">
          <label>Card Number <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="cardNumber" required placeholder="4111 1111 1111 1111" maxlength="19" autocomplete="cc-number" data-form="payment">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Expiry Date <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="expiry" required placeholder="MM/YY" maxlength="5" autocomplete="cc-exp" data-form="payment">
          </div>
          <div class="form-group">
            <label>CVV <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="cvv" required placeholder="123" maxlength="4" autocomplete="cc-csc" data-form="payment">
          </div>
        </div>
        <div class="form-group">
          <label>Amount</label>
          <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
            <span style="font-size: 1.2rem;">$</span>
            <input type="number" name="amount" value="99.99" step="0.01" min="0.01" style="width: 150px;" data-form="payment">
          </div>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Pay Now</button>
      </form>
    </div>

    <!-- Survey Form -->
    <div class="card">
      <h3>4. Survey Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Customer satisfaction survey with various input types</p>
      <form id="surveyForm" onsubmit="handleFormSubmit(event, 'survey')">
        <div class="form-group">
          <label>How satisfied are you with our service? <span style="color: var(--danger-color);">*</span></label>
          <div style="display: flex; gap: var(--spacing-md); flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="radio" name="satisfaction" value="very-satisfied" required data-form="survey"> Very Satisfied
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="radio" name="satisfaction" value="satisfied" data-form="survey"> Satisfied
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="radio" name="satisfaction" value="neutral" data-form="survey"> Neutral
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="radio" name="satisfaction" value="dissatisfied" data-form="survey"> Dissatisfied
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="radio" name="satisfaction" value="very-dissatisfied" data-form="survey"> Very Dissatisfied
            </label>
          </div>
        </div>
        <div class="form-group">
          <label>Rate your experience (1-10)</label>
          <input type="range" name="rating" min="1" max="10" value="5" style="width: 100%;" oninput="document.getElementById('ratingValue').textContent = this.value" data-form="survey">
          <div class="text-sm text-muted" style="display: flex; justify-content: space-between;">
            <span>Poor (1)</span>
            <span>Current: <strong id="ratingValue">5</strong></span>
            <span>Excellent (10)</span>
          </div>
        </div>
        <div class="form-group">
          <label>Which features do you use most? (Select all that apply)</label>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-sm);">
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="dashboard" data-form="survey"> Dashboard
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="analytics" data-form="survey"> Analytics
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="reports" data-form="survey"> Reports
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="integrations" data-form="survey"> Integrations
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="api" data-form="survey"> API Access
            </label>
            <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
              <input type="checkbox" name="features" value="support" data-form="survey"> Support
            </label>
          </div>
        </div>
        <div class="form-group">
          <label>How did you hear about us?</label>
          <select name="referral" data-form="survey">
            <option value="">Select an option...</option>
            <option value="search">Search Engine</option>
            <option value="social">Social Media</option>
            <option value="friend">Friend/Colleague</option>
            <option value="ad">Advertisement</option>
            <option value="blog">Blog/Article</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div class="form-group">
          <label>Additional Comments</label>
          <textarea name="comments" rows="3" placeholder="Share your thoughts..." data-form="survey"></textarea>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Submit Survey</button>
      </form>
    </div>

    <!-- Shipping Form -->
    <div class="card">
      <h3>5. Shipping Address Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Address form with autocomplete hints</p>
      <form id="shippingForm" onsubmit="handleFormSubmit(event, 'shipping')">
        <div class="form-group">
          <label>Full Name <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="fullName" required placeholder="John Doe" autocomplete="name" data-form="shipping">
        </div>
        <div class="form-group">
          <label>Street Address <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="address1" required placeholder="123 Main Street" autocomplete="address-line1" data-form="shipping">
        </div>
        <div class="form-group">
          <label>Apartment, Suite, etc.</label>
          <input type="text" name="address2" placeholder="Apt 4B" autocomplete="address-line2" data-form="shipping">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>City <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="city" required placeholder="New York" autocomplete="address-level2" data-form="shipping">
          </div>
          <div class="form-group">
            <label>State/Province <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="state" required placeholder="NY" autocomplete="address-level1" data-form="shipping">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>ZIP/Postal Code <span style="color: var(--danger-color);">*</span></label>
            <input type="text" name="postalCode" required placeholder="10001" autocomplete="postal-code" data-form="shipping">
          </div>
          <div class="form-group">
            <label>Country <span style="color: var(--danger-color);">*</span></label>
            <select name="country" required autocomplete="country" data-form="shipping">
              <option value="">Select country...</option>
              <option value="US">United States</option>
              <option value="CA">Canada</option>
              <option value="UK">United Kingdom</option>
              <option value="AU">Australia</option>
              <option value="DE">Germany</option>
              <option value="FR">France</option>
              <option value="JP">Japan</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Phone Number</label>
          <input type="tel" name="phone" placeholder="+1 (555) 123-4567" autocomplete="tel" data-form="shipping">
        </div>
        <div class="form-group">
          <label>Delivery Instructions</label>
          <textarea name="instructions" rows="2" placeholder="Leave at door, ring bell, etc." data-form="shipping"></textarea>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Save Address</button>
      </form>
    </div>

    <!-- Login Form -->
    <div class="card">
      <h3>6. Login Form</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Simple login form with remember me option</p>
      <form id="loginForm" onsubmit="handleFormSubmit(event, 'login')">
        <div class="form-group">
          <label>Email or Username <span style="color: var(--danger-color);">*</span></label>
          <input type="text" name="username" required placeholder="john@example.com" autocomplete="username" data-form="login">
        </div>
        <div class="form-group">
          <label>Password <span style="color: var(--danger-color);">*</span></label>
          <div class="password-wrapper">
            <input type="password" name="password" id="loginPassword" required placeholder="Enter password" autocomplete="current-password" data-form="login">
            <button type="button" class="toggle-password" onclick="togglePassword('loginPassword', this)">Show</button>
          </div>
        </div>
        <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
          <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer; margin: 0;">
            <input type="checkbox" name="remember" data-form="login">
            <span>Remember me</span>
          </label>
          <a href="#" style="color: var(--primary-color); font-size: 0.85rem;">Forgot password?</a>
        </div>
        <button type="submit" class="btn btn-primary btn-sm" style="width: 100%;">Sign In</button>
      </form>
    </div>

    <!-- Form Interaction Log -->
    <div class="card">
      <h3>Form Interaction Log</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Real-time log of form field interactions</p>
      <div id="formInteractionLog" class="code-block" style="max-height: 200px; overflow-y: auto; font-size: 0.8rem;">Waiting for form interactions...</div>
      <button class="btn btn-secondary btn-sm mt-05" onclick="clearInteractionLog()">Clear Log</button>
    </div>
  </div>

  <!-- IDENTIFY MODAL -->
  <div class="modal-overlay" id="identifyModalOverlay" onclick="closeIdentifyModal(event)">
    <div class="modal" onclick="event.stopPropagation()">
      <h3 style="margin-bottom: var(--spacing-md);">Identify User</h3>
      <p class="text-sm text-muted" style="margin-bottom: var(--spacing-md);">Enter your email to identify yourself.</p>
      <form id="identifyForm" onsubmit="handleIdentifySubmit(event)">
        <div class="form-group">
          <label for="identifyName">Full Name <span style="color: var(--danger-color);">*</span></label>
          <input type="text" id="identifyName" placeholder="John Doe" required>
        </div>
        <div class="form-group">
          <label for="identifyEmail">Email Address <span style="color: var(--danger-color);">*</span></label>
          <input type="email" id="identifyEmail" placeholder="john@example.com" required>
        </div>
        <div id="generatedIdPreview" style="display: none; margin-bottom: var(--spacing-md);">
          <label class="text-sm">Generated User ID:</label>
          <div class="code-block" id="generatedIdDisplay" style="margin-top: var(--spacing-xs);"></div>
        </div>
        <div style="display: flex; gap: var(--spacing-sm); justify-content: flex-end; margin-top: var(--spacing-md);">
          <button type="button" class="btn btn-secondary btn-sm" onclick="closeIdentifyModalBtn()">Cancel</button>
          <button type="submit" class="btn btn-primary btn-sm">Identify</button>
        </div>
      </form>
      <div id="identifySuccess" style="display: none;">
        <div class="success-box"><p><strong>Successfully identified!</strong></p></div>
        <div style="margin-bottom: var(--spacing-md);"><label class="text-sm">User ID:</label><div class="code-block" id="successUserId"></div></div>
        <div style="margin-bottom: var(--spacing-md);"><label class="text-sm">Name:</label><div class="code-block" id="successName"></div></div>
        <div style="margin-bottom: var(--spacing-md);"><label class="text-sm">Email:</label><div class="code-block" id="successEmail"></div></div>
        <button type="button" class="btn btn-primary btn-sm" onclick="closeIdentifyModalBtn()" style="width: 100%;">Done</button>
      </div>
    </div>
  </div>

  <div class="toast-container" id="toastContainer"></div>
  <script src="js/main.js"></script>
  <script>
    // Form analytics data (persists in localStorage)
    function loadFormAnalytics() {
      const stored = localStorage.getItem('formAnalytics');
      if (stored) return JSON.parse(stored);
      return { totalSubmissions: 0, successfulSubmissions: 0, failedSubmissions: 0, abandonedForms: 0 };
    }

    function saveFormAnalytics() {
      localStorage.setItem('formAnalytics', JSON.stringify(formAnalytics));
    }

    const formAnalytics = loadFormAnalytics();

    function updateAnalyticsDisplay() {
      document.getElementById('totalSubmissions').textContent = formAnalytics.totalSubmissions;
      document.getElementById('successfulSubmissions').textContent = formAnalytics.successfulSubmissions;
      document.getElementById('failedSubmissions').textContent = formAnalytics.failedSubmissions;
      document.getElementById('abandonedForms').textContent = formAnalytics.abandonedForms;
    }

    function resetFormAnalytics() {
      formAnalytics.totalSubmissions = 0;
      formAnalytics.successfulSubmissions = 0;
      formAnalytics.failedSubmissions = 0;
      formAnalytics.abandonedForms = 0;
      saveFormAnalytics();
      updateAnalyticsDisplay();
      showToast('Form analytics reset', 'success');
    }

    updateAnalyticsDisplay();

    // Track form interactions
    const interactionLog = document.getElementById('formInteractionLog');
    let interactionCount = 0;

    function logInteraction(type, formName, fieldName, value = '') {
      interactionCount++;
      const timestamp = new Date().toLocaleTimeString();
      const maskedValue = value.length > 0 ? (fieldName.toLowerCase().includes('password') ? '••••••••' : value.substring(0, 20) + (value.length > 20 ? '...' : '')) : '';
      const entry = `[${timestamp}] ${type.toUpperCase()} - ${formName}/${fieldName}${maskedValue ? ': ' + maskedValue : ''}\n`;

      if (interactionLog.textContent === 'Waiting for form interactions...') {
        interactionLog.textContent = '';
      }
      interactionLog.textContent = entry + interactionLog.textContent;

      // Track event via uzera
      if (window.uzera && window.uzera.trackEvent) {
        window.uzera.trackEvent('form_interaction', {
          type: type,
          form: formName,
          field: fieldName,
          timestamp: new Date().toISOString()
        });
      }
    }

    function clearInteractionLog() {
      interactionLog.textContent = 'Waiting for form interactions...';
      interactionCount = 0;
      showToast('Interaction log cleared', 'success');
    }

    // Add event listeners to all form fields
    document.querySelectorAll('input[data-form], select[data-form], textarea[data-form]').forEach(field => {
      const formName = field.dataset.form;
      const fieldName = field.name || field.id || 'unnamed';

      field.addEventListener('focus', () => logInteraction('focus', formName, fieldName));
      field.addEventListener('blur', () => logInteraction('blur', formName, fieldName, field.value));
      field.addEventListener('change', () => logInteraction('change', formName, fieldName, field.value));
    });

    // Handle form submissions
    async function handleFormSubmit(event, formName) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      logInteraction('submit', formName, 'form', JSON.stringify(data).substring(0, 50));

      formAnalytics.totalSubmissions++;

      // Simulate API call
      try {
        const response = await fetch('https://jsonplaceholder.typicode.com/posts', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ formName, data, timestamp: new Date().toISOString() })
        });

        if (response.ok) {
          formAnalytics.successfulSubmissions++;
          saveFormAnalytics();
          updateAnalyticsDisplay();
          showToast(`${formName.charAt(0).toUpperCase() + formName.slice(1)} form submitted successfully!`, 'success');
          logInteraction('success', formName, 'form', 'Submission successful');

          // Track event
          if (window.uzera && window.uzera.trackEvent) {
            window.uzera.trackEvent('form_submit', {
              form: formName,
              success: true,
              timestamp: new Date().toISOString()
            });
          }

          // Reset form after successful submission
          form.reset();
        } else {
          throw new Error('Submission failed');
        }
      } catch (error) {
        formAnalytics.failedSubmissions++;
        saveFormAnalytics();
        updateAnalyticsDisplay();
        showToast(`${formName} form submission failed`, 'error');
        logInteraction('error', formName, 'form', error.message);

        if (window.uzera && window.uzera.trackEvent) {
          window.uzera.trackEvent('form_submit', {
            form: formName,
            success: false,
            error: error.message,
            timestamp: new Date().toISOString()
          });
        }
      }
    }

    // Track form abandonment (when user leaves page with partially filled form)
    let formStarted = {};

    document.querySelectorAll('form').forEach(form => {
      const formId = form.id;
      form.addEventListener('input', () => {
        if (!formStarted[formId]) {
          formStarted[formId] = true;
        }
      });
    });

    window.addEventListener('beforeunload', () => {
      Object.keys(formStarted).forEach(formId => {
        const form = document.getElementById(formId);
        if (form && formStarted[formId]) {
          const formData = new FormData(form);
          let hasData = false;
          formData.forEach(value => { if (value) hasData = true; });
          if (hasData) {
            formAnalytics.abandonedForms++;
            saveFormAnalytics();
          }
        }
      });
    });
  </script>
</body>
</html>
